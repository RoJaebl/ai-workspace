# 커밋 메시지 가이드

## Conventional Commits 타입

| 타입       | 용도                                       | 예시                                    |
|------------|--------------------------------------------|-----------------------------------------|
| `feat`     | 새로운 기능 추가                           | `feat(인증): JWT 토큰 갱신 기능 구현`   |
| `fix`      | 버그 수정                                  | `fix(결제): 금액 계산 오류 수정`        |
| `docs`     | 문서 변경                                  | `docs(API): 인증 API 문서 업데이트`     |
| `refactor` | 기능 변경 없는 코드 개선                   | `refactor(인증): 인증 로직 모듈화`      |
| `test`     | 테스트 추가/수정                           | `test(인증): 토큰 갱신 테스트 추가`     |
| `chore`    | 빌드, 설정, 의존성 등 유지보수             | `chore(의존성): jsonwebtoken 업데이트`  |
| `style`    | 코드 포맷팅 (세미콜론, 공백 등)            | `style(전체): Prettier 포맷 적용`       |
| `perf`     | 성능 개선                                  | `perf(쿼리): 조회 쿼리 최적화`          |
| `ci`       | CI/CD 설정 변경                            | `ci(배포): GitHub Actions 워크플로우 추가` |

## 메시지 구조

```
<type>(<scope>): <subject>
<BLANK LINE>
<body>
<BLANK LINE>
<footer>
```

### Subject 규칙

- 50자 이내
- 마침표 없음
- 명령형/현재형 사용 (추가, 수정, 개선)
- 첫 글자 대문자 불필요 (한글)

### Body 규칙

- 72자마다 줄바꿈
- "무엇"과 "왜"를 설명 ("어떻게"는 코드가 설명)
- 변경 사항을 불릿 포인트로 나열

### Footer 규칙

- 이슈 참조: `Fixes #123`, `Closes #456`
- Breaking Change: `BREAKING CHANGE: <설명>`

## 타입별 템플릿

### feat (기능 추가)

```
feat(<scope>): <새 기능 설명>

<기능의 목적과 동작 방식 설명>

- <변경사항 1>
- <변경사항 2>

영향: <사용자/시스템에 미치는 영향>
```

**예시:**

```
feat(인증): JWT 토큰 자동 갱신 기능 구현

토큰 만료 전 자동으로 갱신하여 사용자 경험을 개선하고
인증 실패를 줄입니다.

- JWTHandler 클래스 추가 (토큰 생명주기 관리)
- AuthService에 refreshToken() 메서드 구현
- 자동 갱신을 위한 TokenRefreshMiddleware 추가

영향: 인증 실패 90% 감소, 끊김 없는 사용자 경험
```

### fix (버그 수정)

```
fix(<scope>): <수정된 문제 설명>

<문제 상황과 원인 설명>
<해결 방법 설명>

- <수정사항 1>
- <수정사항 2>

Fixes #<이슈 번호>
```

**예시:**

```
fix(결제): 결제 금액 계산 오류 수정

부가세 계산 시 소수점 반올림 오류로 인해
실제 결제 금액과 불일치하는 문제 해결

- 부가세 계산 로직 수정 (Math.round 적용)
- 최종 금액 검증 로직 추가
- 결제 금액 테스트 케이스 보강

Fixes #456
```

### docs (문서)

```
docs(<scope>): <문서 변경 설명>

<변경된 문서 내용 요약>

- <변경사항 1>
- <변경사항 2>
```

**예시:**

```
docs(API): 인증 API 문서 업데이트

JWT 토큰 갱신 엔드포인트 및 사용법 추가

- POST /api/auth/refresh 엔드포인트 문서화
- 토큰 갱신 요청/응답 예제 추가
- 에러 코드 및 처리 방법 설명
```

### refactor (리팩토링)

```
refactor(<scope>): <리팩토링 설명>

<리팩토링 목적과 방법 설명>

- <변경사항 1>
- <변경사항 2>

영향: <코드 품질/유지보수성 개선 효과>
```

**예시:**

```
refactor(인증): 인증 로직 모듈화 및 구조 개선

단일 책임 원칙을 적용하여 AuthService를
토큰 관리, 사용자 검증, 세션 관리로 분리

- JWTHandler로 토큰 관련 로직 분리
- UserValidator로 사용자 검증 로직 분리
- SessionManager로 세션 관리 로직 분리

영향: 코드 복잡도 40% 감소, 테스트 용이성 향상
```

### test (테스트)

```
test(<scope>): <테스트 추가/수정 설명>

<테스트 목적과 커버리지 설명>

- <테스트 시나리오 1>
- <테스트 시나리오 2>

커버리지: <변경 전> → <변경 후>
```

**예시:**

```
test(인증): JWT 토큰 갱신 테스트 스위트 추가

토큰 갱신 기능의 모든 시나리오를 커버하는
포괄적인 테스트 추가

- 정상 토큰 갱신 시나리오
- 만료된 리프레시 토큰 처리
- 유효하지 않은 토큰 처리
- 동시 갱신 요청 처리

커버리지: 인증 모듈 95% → 98%
```

### chore (유지보수)

```
chore(<scope>): <유지보수 작업 설명>

<작업 목적과 내용 설명>

- <변경사항 1>
- <변경사항 2>

참고: <관련 링크나 정보>
```

**예시:**

```
chore(의존성): jsonwebtoken 라이브러리 업데이트

보안 취약점 수정을 위해 jsonwebtoken을
8.5.1에서 9.0.0으로 업그레이드

- 주요 변경사항: ES6 모듈 지원
- Breaking change: 콜백 방식 → Promise 방식
- 관련 코드 마이그레이션 완료

참고: https://github.com/auth0/node-jsonwebtoken/releases
```

## 변경사항 분석 프로세스

### 1단계: Git 상태 확인

```bash
git status --short
git diff --stat
git diff --staged --stat
```

### 2단계: 변경 유형 결정

| 변경 내용                    | 타입       |
|------------------------------|------------|
| 새 기능, 새 파일             | `feat`     |
| 버그 수정, 오류 해결         | `fix`      |
| README, JSDoc, 주석          | `docs`     |
| 코드 구조 변경, 이름 변경    | `refactor` |
| 테스트 파일 추가/수정        | `test`     |
| package.json, 설정 파일      | `chore`    |

### 3단계: Scope 결정

- 변경된 모듈/컴포넌트 이름 사용
- 한글로 작성 (예: 인증, 결제, 사용자, UI)
- 여러 영역에 걸친 변경은 가장 핵심적인 영역 선택

### 4단계: Subject 작성

- 변경의 핵심을 한 문장으로 요약
- 명령형 사용: "추가", "수정", "개선", "구현"
- 50자 이내 유지

## 복잡한 변경사항 처리

### 여러 커밋으로 분리해야 할 경우

1. **의존성 순서 고려**: 기반 변경 → 의존 변경
2. **논리적 그룹화**: 관련 변경끼리 묶기
3. **테스트 별도 커밋**: 코드 변경과 테스트 분리

**예시 (대규모 인증 기능 추가):**

```
커밋 1: feat(인증): JWT 토큰 핵심 로직 구현
커밋 2: feat(인증): 인증 미들웨어 추가
커밋 3: feat(API): 토큰 갱신 엔드포인트 구현
커밋 4: feat(UI): 로그인 페이지 토큰 갱신 연동
커밋 5: test(인증): 토큰 갱신 테스트 스위트 추가
커밋 6: docs(인증): 인증 API 문서 업데이트
```

## 피해야 할 패턴

- ❌ "작업 완료", "버그 수정", "업데이트"
- ❌ 너무 긴 제목 (50자 초과)
- ❌ 관련 없는 변경사항 한 커밋에 포함
- ❌ 추적되지 않은 파일 언급
- ❌ WIP 커밋 (작업 중인 상태로 커밋)
